#!/bin/bash
if [ "$#" -ne 2 ]; then
    echo "You need to provide 2 arguments for this script."
    echo "Usage: make-go-dir <root directory name> <identifier name>"
    exit 1
fi

ROOT_DIR=$1
IDENTIFIER=$2

echo "I am about to create a directory structure named '$ROOT_DIR'."
read -p "Do you want me to continue? [Yes/No] " ANSWER

if [[ "$ANSWER" != "Yes" ]]; then
    echo "Abort."
    exit 0
fi

echo "create directory structure..."
mkdir -p "$ROOT_DIR"/{bin,cmd/api,internals,migrations,remote}

touch "$ROOT_DIR/make-file" "$ROOT_DIR/go.mod" "$ROOT_DIR/cmd/api/main.go"

cat > "$ROOT_DIR/cmd/api/main.go" <<EOG
// File: cmd/api/main.go

package main

import "fmt"

func main() {
        fmt.Println("Hello world!")
}
EOG

echo "module $ROOT_DIR.$IDENTIFIER" > "$ROOT_DIR/go.mod"

echo "I have created a *main.go* file for you to test the directory structure."
echo "Type *go run ./cmd/api* at the root directory of your project to test your project"
echo "Thank you"
